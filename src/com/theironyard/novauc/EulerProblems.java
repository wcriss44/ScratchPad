package com.theironyard.novauc;

import java.lang.reflect.Array;
import java.math.BigInteger;
import java.util.ArrayList;
import java.util.HashMap;

public class EulerProblems {

/********************************************************************************************
 *                                          Problem 1
 * Each new term in the Fibonacci sequence is generated by adding the previous two terms.
 * By starting with 1 and 2, the first 10 terms will be:
 *
 * 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
 *
 * By considering the terms in the Fibonacci sequence whose values do not exceed four million,
 * find the sum of the even-valued terms.
 *
 ********************************************************************************************/
    public int evenFibs(int n){
        int sum = 1;
        int sum2 = 2;
        int middleMan;
        int runningTotal = 3;
        int finalValue = 2;

        while (runningTotal < n){
            middleMan = sum2;
            sum2+=sum;
            sum = middleMan;
            runningTotal = sum2;
            if (sum2%2 == 0) {
                finalValue += sum2;
            }
        }
        return finalValue;
    }

    /********************************************************************************************
     *                                          Problem 2
     * If we list all the natural numbers below 10 that are multiples of 3 or 5, we get 3, 5, 6 and 9.
     * The sum of these multiples is 23.
     *
     * Find the sum of all the multiples of 3 or 5 below 1000.
     *
     ********************************************************************************************/

    public int multiples35(int n){
        int result = 0;
        for(int i = 1; i < n; i++) {
            if (i % 3 == 0 || i % 5 == 0) {
                result += i;
            }
        }
        return result;
    }

    /********************************************************************************************
     *                                          Problem 3
     * The prime factors of 13195 are 5, 7, 13 and 29.
     *
     * What is the largest prime factor of the number 600851475143 ?
     *
     ********************************************************************************************/

    public long largesPrimeFacts(long n){
        boolean divisionTest;
        long bigCheck = 0L;
        ArrayList<Long> factors = new ArrayList<>();
        for (long i = 2; i < n; i++){
            divisionTest = false;
            if (n % i == 0){
                productCheck:for (long x = 2; x <= i; x++){
                    if (i % x == 0 && x != i){ //this is causing a bug when x and i are equal
                        divisionTest = false;
                        break productCheck;
                    }
                    if (x == i){
                        divisionTest = true;
                    }
                }
            } if (divisionTest){
                n = n/i;
                factors.add(i);
            }
        }
        factors.add(n);
        for(Long i: factors){
            if (i.longValue() > bigCheck){
                bigCheck = i.longValue();
            }
        }
        return n > bigCheck ? n:bigCheck;
    }

    /********************************************************************************************
     *                                          Problem 4
     * A palindromic number reads the same both ways.
     * The largest palindrome made from the product of two 2-digit numbers is 9009 = 91 × 99.
     *
     * Find the largest palindrome made from the product of two 3-digit numbers.
     *
     ********************************************************************************************/

    public int pallyNumb(int firstMax, int secondMax){
        ArrayList<Integer> numberStorage = new ArrayList<>();
        for (int x = firstMax; x > 0; x--){
            for (int y = secondMax; y > 0; y--){
                String check = String.format("%s",x*y);
                StringBuilder checkerString = new StringBuilder(check);
                int back = Integer.valueOf(checkerString.reverse().toString());
                int front = x*y;
                if(front == back){
                    numberStorage.add(front);
                }
            }
        }
        int ans = 1;
        for(Integer i : numberStorage){
            if (i > ans){
                ans = i;
            }
        }
        return ans;
    }

    /********************************************************************************************
     *                                          Problem 5
     * The Fibonacci sequence is defined by the recurrence relation:
     * Fn = Fn−1 + Fn−2, where F1 = 1 and F2 = 1.
     * Hence the first 12 terms will be:
     * F1 = 1
     * F2 = 1
     * F3 = 2
     * F4 = 3
     * F5 = 5
     * F6 = 8
     * F7 = 13
     * F8 = 21
     * F9 = 34
     * F10 = 55
     * F11 = 89
     * F12 = 144
     * The 12th term, F12, is the first term to contain three digits.
     *
     * What is the index of the first term in the Fibonacci sequence to contain 1000 digits?
     *
     ********************************************************************************************/

    public int fibIndex(int n){
        BigInteger firstNum = BigInteger.ZERO;
        BigInteger secondNum = BigInteger.ONE;
        BigInteger fib = BigInteger.valueOf(2);
        BigInteger middleMan;
        BigInteger i = BigInteger.valueOf(3);
        BigInteger bigN = BigInteger.TEN;
        BigInteger looper = BigInteger.TEN;
        while (n > 0){
            bigN = bigN.multiply(looper);
            n--;
        }
        while (fib.compareTo(bigN) == -1){
            i = i.add(BigInteger.ONE);
            middleMan = secondNum;
            secondNum = secondNum.add(firstNum);
            firstNum = middleMan;

            fib = fib.add(secondNum);
        }
        return i.intValue();
    }

    /********************************************************************************************
     *                                          Problem 6
     * 2520 is the smallest number that can be divided by each of the numbers
     * from 1 to 10 without any remainder.
     *
     * What is the smallest positive number that is evenly divisible by all
     * of the numbers from 1 to 20?
     *
     ********************************************************************************************/

    public int smallestMulti(){
        int i = 20;
        while(true){
            i++;
            if (i%20 == 0 && i%19 == 0 && i%18 == 0&& i%17 == 0 && i%16 == 0 && i%15 == 0 && i%14 == 0 && i%13 == 0 && i%12 == 0 && i%11 == 0 && i%10 == 0 && i%9 == 0 && i%8 == 0&& i%7 == 0 && i%6 == 0 && i%5 == 0 && i%4 == 0 && i%3 == 0 && i%2 == 0){
                String a = "3752328845409261591607168110268347881502885371646934451948355475553650948475551364528108043952030946299950443492911046043108313013202420659889860715489421070279477789135776682897618246496191276962882156419423432718189887848160444851065243185157240046919103957139292227908686441224654482941220730544713544063988772686325382462619846149637723976385452292993510770262975949788916771242660007185597827055004395539735261765015063823958934925078820813078354916079101237379073061999486152179185804650138428556691358155379094357038837171652737004479140391696483518835982712362230168626675238638121565280668217105076092531265493105521274050852949914503634435593876015624187188608779125333210729962452263132999282920519404954305023948453796264635896599068317275499207418446954197477475238398917653929808487679058141243707236504190118603148562407856066576299591944485426898441834100157242280022835657248994707141816879505952437489385254902395782709721061761216578705731519761371594782572900045961921255703269584412110795261983653665966889609286189261696594053404830925696744960784312931992279239347042298876415643528776137511051171967367566782795101412281135458425068430300985375043066934735584909267984669910754402771935898568792747584694235798868283970252857764775302474957080217048752286124295504143344814137153108208611693502802721310497775076007266206958134798058685708059157210495607427287367731822881505412575328145330349157974866105531253730666326280389065700264399986646156744785718967458674875353387825571628153316350084054683734528993656554415438618587594702485261446388829013685607456345216822517039978192058880615464860815884288957006030735647523604995521210924548804960539078037988179220989529406108150435514905002528509708550675202805447188928961148602014330619795813559423336094398439991301769007495111933951169385742581699728206819416596343738184483501619511623278008308308261587081867213808591057661138755997777364729755119261481272907058636317060606419892345677930185503212361041143174203684800917473897873692169281032580775835344500741428482631749450863481323770173547711361595029524382819836883533346512970690821234573961238551069461994870906094587695279557837579650331842448928133613798274707002962813719615423591632347567893999352873493359054533277267652928874365659936159585086374252844243210844986383293940658525967497438446014851371526809361307817071983438853269798815013176853609586472985345264091755898346100056055776193465062359048674979403298445606346178820980754128526420090656480392103042108075172182150068750696327416548612607335551992665185589885395634158980874706283602542692510792057696672474057809954181349044809381626556706533373178904149399763171416275228231378865236297117631162734443734942137002746530010022744017453023778406533178649046318663223462975522378745697650599386137767388156387488799533234633667069689093058110942000546794560578666232319132063836775719616425552438241027850009774854909065501274655253590449735253168244965746319582334519231848333955798501123279765016744570427960791425923546364487199619540099108381057222457153967682609181692275842997975876990050804121903465907200035189545537977295846526833165502663819109467326629635801601842702857500537465849016814145891351497965032391446458802619606277992262636522513235023254678768058078329120372613665493166176150255807640279167759217858056750322556456552480640322738867336509268824020219873800206196814557979014067339464945504452448712703450815338656654101071138721314475046295140431965018859991801145563818398303574766277449045871282660477094298308301472042321641011246252618082329834005093147045427170913129965007133027299749161580109118436517477033686922899118194705563220309369848171940908641272287959491870306765067227216574936543467781344136250102357283465510021224480463772452740608086714166715037619735160949247102989001329498210482386851233353285720242939097277845842111407541728955463244069812735565245381720017661407703490885862914190955183874572214071799709839765742174691900879800009403252351814673316490852852639481683168988299535567701182091146008361553889896282178459430657281373548772852962828849077091830992877028932082741976805998832643361535805307946006156182262401118866848090070974472802997642343550652277437803451186152770537560666404597035521940299910659099122019072796678987184379401464681587739771176421433417495069157067382309542419318268042443709197881010130957835666883265885156542722977691407917419162614070735726782134292388046274963181225103406713060181959383913312152722879964092667944421905746971993560888690329165951945705550154065130795716621640769741936900263871203815495826418273676784398492529876893605927958523430123360146029029698496831446847192402293302153134371089821104262433819809574236711700948159788451633290361257867356507171679883636413108904152495879607118431963542692886179835738073278827540403287919060194812554021027541336354737544733491465067411926283377070029731139174769334477589620450653841485001845259603539482114709531150293094196105852092741876610273943551348825785414774221847947233990684495184890701900083791521776300514693149883387897662080026850415111901353056380278588435372234494389183472868475477580416739344588193254608644223889299729100917040622495490216280539606515409316540056331693060074808373758049235539836314645118097751052709326075319089690341411581254570126408322984739721614945713275562203982678676405147818919718806213410779848238664083569752200487956385266429554266474869568054331066651136122785520769349158789808408014146444921277173887997648643262672090895241119072021494631329045223787643995897920565355182823931735671910556396231147978497253813727089842233685484763477917278823083492409759687718604473974747294175697803465366184168523972867499582718290780789299953403306929970407245906333756597295396679604992784117163560131721517721585999045540402647152400437812619406352512437270467727792035390565269940562558346670767283610414054729789780219170485210919022198548207842329378743091985087747819957450927876639140484516447999469335059323341509697306742588689206261886294361783727408718580798956494405144563250907445759611960725091524789451549032758723187973693441019009549068933996867461885031659119324589908865071996157840822904532479453075415677327026764995298118384464495890836773907298677602480755371454480387547679968850956135902633544260657287928165321689566699908333455458366115780131573105939066598882997509840473309623832105167687228363727495932509383160078231553683999372967794676095542729124309471268219688123485140717060665565235025068850888726114136712969327478828196830708640159259172061760193735767971690536632721719928651932990420723795080587489442153870434963909878962956764680015405813088668268161436672997189024785745223381427352314725494976449588316260785256909439133544875298636604574434117686987955856581744261611541435523416235392714234503614884243648154134118688798292140791641413699516528021819986421930200662554347177437323356661297362435450150505936464256856275007023047660818678675637403166165183017402582457151628201265229223001217216680074109822190859643869781477485300442231563540571466661734381076463268843698341965412569441063873989602712214165860089137940041978237015900545800619901191300331950120541675600346256762949281497716718633276668282406657538052656634994448213534976444588655573243352706837764876898856464609908358622200158827806697230311546494202774625989308771507312027819358358560697700462791134830482487996585047901674555104747192481728382316877496372367336331401353296831647914173681669345709328511831541159140858042497157737162355853404718644388373512565390022916305391556966874799247751246296659545031519164361705687123897048072803168810120775759581815778883651283674311466513053115004423441364104109999414966686686316903189569859339664159680730354015158976905064899013368116038984906886266064480324382579260284576955022884113139719141240475454901686094994728980179190226482219146556790227249570685566396712862345877256871256502254548383695862655070417601225227628803291935735998726968821560451399185323118967019726513273118209389001111362855248662744149840436158429284996072883672908216055501025481646452773954708602430901336217931128527355249318398879777152474286050894056320296061417082733723072636695141033205878955159225438862057647511200231893453080551087397182682827573927938330703162455328993103062139794239905044184153313231778662899475694234738428747251959528879532634424877511605692370441838180639084177895092389204222512412967904413556340601783067784880201665225108113843070826528527393492053101129323218322830117572328823754524291668570431946904010713020088085356175195922533603083466950815440989874538046542544106084008153207511598410829228313542796294096756521618187169948631891068130381878159741294720918794064468534806407646877777511806829592038405189242973454388923705289839690889168551437364206232903692622344977458330538278182262415925092950475889549351185823678888935956520165213531895217005861615150684910452472128457524961530552419151776196580346898410109151609423254346351645959721135481981220692638814965012816525355960399334725841735409612771050169517131459558289691498125146568624844326465536381091277407115341543611069057580207676717192010765774256620535486856868653425387743802003161323325456070492215287355644825280015544008840083718703761984931128517099943628388002203986792511408009082375070632934497051690410888426823186853071484567883323326375431858388625595077179521229816902452918475526391760917828824641037787827392306768457848675571264555434346243482904086335936666288506081188008814836419665322907174167979554350722707649415641320928327383024143099945890222785380916649260283194614063090858195952039565803539524006441147954958913776411785153934346586607542271004544607570289359101150154520942720811093396862875036452509683135819234875324192671212849948515104306014496311905777462260150217585477926790237260810471350042216713166373272031088439695159635188062800271796670817205386191872385957881330893386276702728433014103449904986153184604500970530496653197388234838788343019473856490548270905638376982581327459581474564672524315825567130914875778298029904226439501804667208412453103633426813452535357159360496919956493014839704524472134340315850026328383783876744313096480622955867768658232487583404963311537204638301709226049909948619872382447069213276266354834951512780112784179779217678473745337278711573233036357892214381468638172559206504434734625015463554831905711145129731566021228979863860453924018107216531033356227978177787856082423602475010643177407072888801933685480303342910930958465287866694837514121495771014197457350194938441233579732792656326166790953394222397359393670411504547036261258187622500290220122809848484512637498692197615031041287996069060366392621893509152235405714146477021335765016476951781247158242308202920066922345509667296192202514118559341149806801176082141154659967867788729212467499650687704403631320756403585521129005437985858484627053263003229948499912669050716397368025771533278291178929327083577422775635893913743603182151473610042054377230160182330385191727314503277393130725847323488250770937898787735296264238881357334301423591494040085587223312679202547519486731267271144381286931514700561143213401089029645306137521083573780346121";
                System.out.println("Your length: " + a.length());
                return i;


            }
        }
    }

    /********************************************************************************************
     *                                          Problem 7
     * The Fibonacci sequence is defined by the recurrence relation:
     *
     * Fn = Fn−1 + Fn−2, where F1 = 1 and F2 = 1.
     *
     * It turns out that F541, which contains 113 digits, is the first Fibonacci number
     * for which the last nine digits are 1-9 pandigital (contain all the digits 1 to 9,
     * but not necessarily in order). And F2749, which contains 575 digits, is the first Fibonacci
     * number for which the first nine digits are 1-9 pandigital.
     *
     * Given that Fk is the first Fibonacci number for which the first nine digits AND the last
     * nine digits are 1-9 pandigital, find k.
     *
     ********************************************************************************************/

    public int fibPanChecker() {
        BigInteger fNum, sNum, fibNum;
        fNum = BigInteger.ONE;
        sNum = BigInteger.ZERO;
        int fibIndex = 1;
        boolean checker = false, theEnd = false;

        something: while(true){

            fibNum = fNum.add(sNum);

            fibIndex++;
            System.out.println("Your index: " + fibIndex);
            //System.out.println("\tYour number: " +fibNum.toString());
            BigInteger endChecker = BigInteger.valueOf(1000000000);


            int end = (fibNum.mod(endChecker)).intValue();
            String back = String.valueOf(end);
            if (fibNum.toString().length() < 19){
            } else {

                for (int x = 1; x <= 9; x++) {
                    if (!back.contains(String.valueOf(x))) {
                        break;
                    }
                    if (x == 9) {
                        theEnd = true;
                    }
                }
                if (theEnd) {
                    String front = fibNum.toString().substring(0, 9);
                    for (int x = 1; x <= 9; x++) {
                        if (!(front.contains(String.valueOf(x)))) {
                            theEnd = false;
                            break;
                        }
                        if (x == 9){
                            checker = true;
                        }
                    }
                    if (checker) {
                        return fibIndex;
                    }
                }
            }
            sNum = fNum;
            fNum = fibNum;
        }
    }
}
